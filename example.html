<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html> <head>
    <title>Second Example Concurrent File Loader</title>

    <script src="./kernel.js"></script>
    <script src="./schematic.js"></script>
    <script src="./fileselector.js"></script>
    <script src="./callbacklogic.js"></script>
    <script src="./text.js"></script>
    
  </head>

  <body>
    <h1></h1>
    <div id="topLevel">
      <script>
	var topLevel = new SchematicComponent("topLevel");  // see initialization, below
      </script>
      
      
      <input type="file" id="part1" onchange="react()"></input>
      <script>
	var fileSelector = new FileSelectorComponent ("fileSelector");
      </script>

      <script>
	var callbackLogic = new CallbackLogic ();
      </script>

      <script>
	var wireFromFileSelectorToCallbackLogic = 
	    new wire ({ sender: {part: FileSelector, pin: null},
			receivers: [{part: CallbackLogic, pin: "file"}]});
      </script>

      <p id="Display"></p>
      <script>
	var Display = new Display ("Display");
      </script>

      <script>
	var wireFromCallbackLogicToDisplay =
	    new wire ({ sender: {part: CallbackLogic, pin: "good"},
			receivers: [ {part: Display, pin: "file descriptor"} ]});
      </script>

      <script>
	var ErrorHandler = new ErrorHandler ();
	var AbortHandler = new AbortHandler ();
	var NoResponseHandler = new NoResponseHandler ();

	var wireFromCallbackLogicToErrorHandler =
	    new wire ({ sender: {part: CallbackLogic, pin: "error"},
			receivers: [{part: ErrorHandler, pin: "in"}]});
	var wireFromCallbackLogicToAbortHandler =
	    new wire ({ sender: {part: CallbackLogic, pin: "abort"},
			receivers: [{part: AbortHandler, pin: "in"}]});
	var wireFromCallbackLogicToNoResponseHandler =
	    new wire ({ sender: {part: CallbackLogic, pin: "no response"},
			receivers: [{part: NoResponseHandler, pin: "in"}]});
      </script>
      
      <script>
	
	// initialization of topLevel part
	topLevel.initializeParts( [FileSelector, Display, ErrorHandler, AbortHandler, NoResponseHandler] );

	topLevel.initializeWires ([
	    wireFromFileSelectorToCallbackLogic,
	    wireFromCallbackLogicToDisplay,
	    wireFromCallbackLogictoErrorHandler,
	    wireFromCallbackLogictoAbortHandler,
	    wireFromCallbackLogictoNoResponseHandler
	]);
      </script>

      <script>
	var kernel = new Kernel (topLevel);
      </script>

    </div>
  </body>
</html>
